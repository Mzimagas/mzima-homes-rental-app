{
  "timestamp": "2025-08-27T09:09:27.152Z",
  "strategy": "soft-delete-with-monitoring",
  "totalEmptyTables": 73,
  "phases": {
    "phase1": {
      "name": "Schema Backup & Monitoring Setup",
      "description": "Create complete backups and monitoring before any changes",
      "duration": "1-2 days",
      "actions": [
        "Create complete schema backup with CREATE statements",
        "Set up table access monitoring",
        "Create restoration scripts",
        "Document all foreign key relationships"
      ],
      "risk": "NONE",
      "reversible": true
    },
    "phase2": {
      "name": "High Priority Soft Archive",
      "description": "Rename obviously unused tables (land sales, marketing)",
      "tables": [
        "clients",
        "encumbrances",
        "listings",
        "offers_reservations",
        "parcel_owners",
        "parcels",
        "plots",
        "property_handover_costs",
        "property_sale_info",
        "property_sale_status_history",
        "property_subdivision_costs",
        "property_subdivision_history",
        "purchase_pipeline_change_approvals",
        "purchase_pipeline_costs",
        "reservation_requests",
        "sale_agreements",
        "subdivision_plots",
        "subdivisions",
        "surveys",
        "transfers_titles",
        "wayleaves_easements",
        "amenities",
        "documents",
        "land_media",
        "land_property_amenities",
        "unit_amenities",
        "units_media",
        "marketing_leads"
      ],
      "tableCount": 28,
      "duration": "1 week monitoring",
      "actions": [
        "Rename tables with _archived_ prefix",
        "Monitor application for errors",
        "Track any access attempts",
        "Verify application functionality"
      ],
      "risk": "LOW",
      "reversible": true,
      "monitoringPeriod": "7 days"
    },
    "phase3": {
      "name": "Medium Priority Soft Archive",
      "description": "Archive maintenance, notification, audit tables",
      "tables": [
        "maintenance_requests",
        "maintenance_tickets",
        "tasks_reminders",
        "in_app_notifications",
        "notification_history",
        "notification_settings",
        "activities_audit",
        "disputes_logs",
        "property_audit_log",
        "approvals",
        "land_details",
        "owners",
        "value_add_projects"
      ],
      "tableCount": 13,
      "duration": "2 weeks monitoring",
      "actions": [
        "Rename tables with _archived_ prefix",
        "Extended monitoring period",
        "Check for scheduled jobs or triggers",
        "Verify no background processes use these tables"
      ],
      "risk": "MEDIUM",
      "reversible": true,
      "monitoringPeriod": "14 days"
    },
    "phase4": {
      "name": "Low Priority Investigation",
      "description": "Careful analysis of financial, utility, auth tables",
      "tables": [
        "bank_mpesa_recons",
        "commissions",
        "expenses",
        "invoices",
        "mpesa_transactions",
        "payment_allocations",
        "payment_plans",
        "property_payment_records",
        "receipts",
        "rent_ledger_view",
        "utility_ledger",
        "meter_readings",
        "shared_meters",
        "unit_shared_meters",
        "utility_accounts",
        "agents",
        "data_access_logs",
        "permission_audit_log",
        "security_events",
        "user_activities",
        "user_data_access",
        "user_invitations",
        "user_next_of_kin",
        "user_permissions",
        "user_profiles",
        "user_property_access",
        "geography_columns",
        "geometry_columns",
        "land_rates",
        "pricing_zones"
      ],
      "tableCount": 30,
      "duration": "1 month analysis",
      "actions": [
        "Detailed code analysis for table references",
        "Check migration files for future plans",
        "Consult with development team",
        "Selective archiving based on analysis"
      ],
      "risk": "HIGH",
      "reversible": true,
      "requiresApproval": true
    },
    "phase5": {
      "name": "Core Table Investigation",
      "description": "Special handling for empty core rental tables",
      "tables": [
        "payments",
        "rent_invoices"
      ],
      "tableCount": 2,
      "duration": "Ongoing analysis",
      "actions": [
        "Verify if empty state is expected",
        "Check if tables are needed for future features",
        "Consult business requirements",
        "NO ARCHIVING without explicit approval"
      ],
      "risk": "CRITICAL",
      "reversible": true,
      "requiresBusinessApproval": true
    }
  },
  "safetyMeasures": {
    "backupStrategy": {
      "fullSchemaBackup": "Complete CREATE statements for all tables",
      "dataBackup": "Full data backup (already completed)",
      "relationshipMapping": "Document all foreign key relationships",
      "accessPatterns": "Log all table access attempts"
    },
    "monitoringStrategy": {
      "errorTracking": "Monitor application logs for table access errors",
      "performanceMetrics": "Track query performance improvements",
      "accessLogging": "Log any attempts to access archived tables",
      "rollbackTriggers": "Automatic rollback if critical errors detected"
    },
    "rollbackStrategy": {
      "immediateRollback": "Rename tables back to original names",
      "dataRestoration": "Restore from backup if needed",
      "relationshipRestoration": "Recreate foreign key constraints",
      "verificationTesting": "Full application testing after rollback"
    }
  },
  "estimatedBenefits": {
    "immediate": {
      "storageReduction": "60-80% (from table archiving)",
      "queryPerformance": "15-25% improvement",
      "backupSpeed": "20-35% faster",
      "schemaClarity": "Much cleaner development experience"
    },
    "afterMonitoring": {
      "storageReduction": "69-94% (if all tables confirmed unused)",
      "queryPerformance": "21-35% improvement",
      "backupSpeed": "28-41% faster",
      "maintenanceReduction": "69% fewer tables to maintain"
    }
  }
}